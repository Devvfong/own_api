<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Photo Gallery</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
<div class="max-w-3xl mx-auto">
  <h1 class="text-3xl font-bold mb-6 text-center">Photo Gallery</h1>
  <div id="gallery" class="grid grid-cols-1 sm:grid-cols-2 gap-6"></div>
</div>

<script>
const API_URL = "https://own-api-bee4.onrender.com/photos";


function loadPhotos() {
  fetch(API_URL)
    .then(res => res.json())
    .then(photos => {
      const gallery = document.getElementById("gallery");
      gallery.innerHTML = '';
      photos.forEach(p => {
        const div = document.createElement("div");
        div.className = "bg-white p-4 rounded shadow relative";
        div.innerHTML = `
          <h3 class="font-semibold mb-2">Title: <input value="${p.title}" id="title-${p.id}" class="border p-1 w-full rounded" /></h3>
          <img src="${p.url}" class="w-full rounded mb-2" />
          <input type="file" id="file-${p.id}" class="mb-2 w-full">
          <button onclick="updatePhoto(${p.id})" class="bg-yellow-400 text-white px-3 py-1 rounded mr-2">Update</button>
          <button onclick="deletePhoto(${p.id})" class="bg-red-500 text-white px-3 py-1 rounded">Delete</button>
        `;
        gallery.appendChild(div);
      });
    });
}

function updatePhoto(id){
  const title = document.getElementById(`title-${id}`).value;
  const fileInput = document.getElementById(`file-${id}`);
  if(fileInput.files.length > 0){
    const reader = new FileReader();
    reader.onload = function(event){
      fetch(`${API_URL}/${id}`, {
        method: "PUT",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({title, url: event.target.result})
      }).then(loadPhotos);
    };
    reader.readAsDataURL(fileInput.files[0]);
  } else {
    fetch(`${API_URL}/${id}`, {
      method: "PUT",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({title})
    }).then(loadPhotos);
  }
}

function deletePhoto(id){
  fetch(`${API_URL}/${id}`, { method: "DELETE" }).then(loadPhotos);
}

loadPhotos();
</script>
</body>
</html>
